function sprintf(){var regex=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,a=arguments,i=0,format=a[i++],pad=function(str,len,chr,leftJustify){chr||(chr=" ");var padding=str.length>=len?"":Array(1+len-str.length>>>0).join(chr);return leftJustify?str+padding:padding+str},justify=function(value,prefix,leftJustify,minWidth,zeroPad,customPadChar){var diff=minWidth-value.length;return diff>0&&(value=leftJustify||!zeroPad?pad(value,minWidth,customPadChar,leftJustify):value.slice(0,prefix.length)+pad("",diff,"0",!0)+value.slice(prefix.length)),value},formatBaseX=function(value,base,prefix,leftJustify,minWidth,precision,zeroPad){var number=value>>>0;return prefix=prefix&&number&&{2:"0b",8:"0",16:"0x"}[base]||"",value=prefix+pad(number.toString(base),precision||0,"0",!1),justify(value,prefix,leftJustify,minWidth,zeroPad)},formatString=function(value,leftJustify,minWidth,precision,zeroPad,customPadChar){return null!=precision&&(value=value.slice(0,precision)),justify(value,"",leftJustify,minWidth,zeroPad,customPadChar)},doFormat=function(substring,valueIndex,flags,minWidth,_,precision,type){var number,prefix,method,textTransform,value;if("%%"==substring)return"%";for(var leftJustify=!1,positivePrefix="",zeroPad=!1,prefixBaseX=!1,customPadChar=" ",flagsl=flags.length,j=0;flags&&flagsl>j;j++)switch(flags.charAt(j)){case" ":positivePrefix=" ";break;case"+":positivePrefix="+";break;case"-":leftJustify=!0;break;case"'":customPadChar=flags.charAt(j+1);break;case"0":zeroPad=!0;break;case"#":prefixBaseX=!0}if(minWidth=minWidth?"*"==minWidth?+a[i++]:"*"==minWidth.charAt(0)?+a[minWidth.slice(1,-1)]:+minWidth:0,0>minWidth&&(minWidth=-minWidth,leftJustify=!0),!isFinite(minWidth))throw new Error("sprintf: (minimum-)width must be finite");switch(precision=precision?"*"==precision?+a[i++]:"*"==precision.charAt(0)?+a[precision.slice(1,-1)]:+precision:"fFeE".indexOf(type)>-1?6:"d"==type?0:void 0,value=valueIndex?a[valueIndex.slice(0,-1)]:a[i++],type){case"s":return formatString(String(value),leftJustify,minWidth,precision,zeroPad,customPadChar);case"c":return formatString(String.fromCharCode(+value),leftJustify,minWidth,precision,zeroPad);case"b":return formatBaseX(value,2,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"o":return formatBaseX(value,8,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"x":return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"X":return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad).toUpperCase();case"u":return formatBaseX(value,10,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case"i":case"d":return number=parseInt(+value),prefix=0>number?"-":positivePrefix,value=prefix+pad(String(Math.abs(number)),precision,"0",!1),justify(value,prefix,leftJustify,minWidth,zeroPad);case"e":case"E":case"f":case"F":case"g":case"G":return number=+value,prefix=0>number?"-":positivePrefix,method=["toExponential","toFixed","toPrecision"]["efg".indexOf(type.toLowerCase())],textTransform=["toString","toUpperCase"]["eEfFgG".indexOf(type)%2],value=prefix+Math.abs(number)[method](precision),justify(value,prefix,leftJustify,minWidth,zeroPad)[textTransform]();default:return substring}};return format.replace(regex,doFormat)}function extendExceptionHandler($delegate,config,logger){var appErrorPrefix=config.appErrorPrefix,logError=logger.getLogFn("app","error");return function(exception,cause){if($delegate(exception,cause),!appErrorPrefix||0!==exception.message.indexOf(appErrorPrefix)){var errorData={exception:exception,cause:cause},msg=appErrorPrefix+exception.message;logError(msg,errorData,!0)}}}function limitWithRetFilter(){return function(input,limit){return void 0==input?"":input.length>limit?input.slice(0,limit)+"...":input}}!function($){$.fn.extend({tableExport:function(options){function parseString(data){return"true"==defaults.htmlContent?content_data=data.html().trim():content_data=data.text().trim(),"true"==defaults.escape&&(content_data=escape(content_data)),content_data}var defaults={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"},options=$.extend(defaults,options),el=this;if("csv"==defaults.type||"txt"==defaults.type){var tdData="";$(el).find("thead").find("tr").each(function(){tdData+="\n",$(this).filter(":visible").find("th").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+='"'+parseString($(this))+'"'+defaults.separator)}),tdData=$.trim(tdData),tdData=$.trim(tdData).substring(0,tdData.length-1)}),$(el).find("tbody").find("tr").each(function(){tdData+="\n",$(this).filter(":visible").find("td").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+='"'+parseString($(this))+'"'+defaults.separator)}),tdData=$.trim(tdData).substring(0,tdData.length-1)}),"true"==defaults.consoleLog&&console.log(tdData);var base64data="base64,"+$.base64.encode(tdData);window.open("data:application/"+defaults.type+";filename=exportData;"+base64data)}else if("sql"==defaults.type){var tdData="INSERT INTO `"+defaults.tableName+"` (";$(el).find("thead").find("tr").each(function(){$(this).filter(":visible").find("th").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+="`"+parseString($(this))+"`,")}),tdData=$.trim(tdData),tdData=$.trim(tdData).substring(0,tdData.length-1)}),tdData+=") VALUES ",$(el).find("tbody").find("tr").each(function(){tdData+="(",$(this).filter(":visible").find("td").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+='"'+parseString($(this))+'",')}),tdData=$.trim(tdData).substring(0,tdData.length-1),tdData+="),"}),tdData=$.trim(tdData).substring(0,tdData.length-1),tdData+=";","true"==defaults.consoleLog&&console.log(tdData);var base64data="base64,"+$.base64.encode(tdData);window.open("data:application/sql;filename=exportData;"+base64data)}else if("json"==defaults.type){var jsonHeaderArray=[];$(el).find("thead").find("tr").each(function(){var jsonArrayTd=[];$(this).filter(":visible").find("th").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&jsonArrayTd.push(parseString($(this)))}),jsonHeaderArray.push(jsonArrayTd)});var jsonArray=[];$(el).find("tbody").find("tr").each(function(){var jsonArrayTd=[];$(this).filter(":visible").find("td").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&jsonArrayTd.push(parseString($(this)))}),jsonArray.push(jsonArrayTd)});var jsonExportArray=[];jsonExportArray.push({header:jsonHeaderArray,data:jsonArray}),"true"==defaults.consoleLog&&console.log(JSON.stringify(jsonExportArray));var base64data="base64,"+$.base64.encode(JSON.stringify(jsonExportArray));window.open("data:application/json;filename=exportData;"+base64data)}else if("xml"==defaults.type){var xml='<?xml version="1.0" encoding="utf-8"?>';xml+="<tabledata><fields>",$(el).find("thead").find("tr").each(function(){$(this).filter(":visible").find("th").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(xml+="<field>"+parseString($(this))+"</field>")})}),xml+="</fields><data>";var rowCount=1;$(el).find("tbody").find("tr").each(function(){xml+='<row id="'+rowCount+'">';var colCount=0;$(this).filter(":visible").find("td").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(xml+="<column-"+colCount+">"+parseString($(this))+"</column-"+colCount+">"),colCount++}),rowCount++,xml+="</row>"}),xml+="</data></tabledata>","true"==defaults.consoleLog&&console.log(xml);var base64data="base64,"+$.base64.encode(xml);window.open("data:application/xml;filename=exportData;"+base64data)}else if("excel"==defaults.type||"doc"==defaults.type||"powerpoint"==defaults.type){var excel="<table>";$(el).find("thead").find("tr").each(function(){excel+="<tr>",$(this).filter(":visible").find("th").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(excel+="<td>"+parseString($(this))+"</td>")}),excel+="</tr>"});var rowCount=1;$(el).find("tbody").find("tr").each(function(){excel+="<tr>";var colCount=0;$(this).filter(":visible").find("td").each(function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(excel+="<td>"+parseString($(this))+"</td>"),colCount++}),rowCount++,excel+="</tr>"}),excel+="</table>","true"==defaults.consoleLog&&console.log(excel);var excelFile="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+defaults.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";excelFile+="<head>",excelFile+="<!--[if gte mso 9]>",excelFile+="<xml>",excelFile+="<x:ExcelWorkbook>",excelFile+="<x:ExcelWorksheets>",excelFile+="<x:ExcelWorksheet>",excelFile+="<x:Name>",excelFile+="{worksheet}",excelFile+="</x:Name>",excelFile+="<x:WorksheetOptions>",excelFile+="<x:DisplayGridlines/>",excelFile+="</x:WorksheetOptions>",excelFile+="</x:ExcelWorksheet>",excelFile+="</x:ExcelWorksheets>",excelFile+="</x:ExcelWorkbook>",excelFile+="</xml>",excelFile+="<![endif]-->",excelFile+="</head>",excelFile+="<body>",excelFile+=excel,excelFile+="</body>",excelFile+="</html>";var base64data="base64,"+$.base64.encode(excelFile);window.open("data:application/vnd.ms-"+defaults.type+";filename=exportData.doc;"+base64data)}else if("png"==defaults.type)html2canvas($(el),{onrendered:function(canvas){var img=canvas.toDataURL("image/png");window.open(img)}});else if("pdf"==defaults.type){var doc=new jsPDF("p","pt","a4",!0);doc.setFontSize(defaults.pdfFontSize);var startColPosition=defaults.pdfLeftMargin;$(el).find("thead").find("tr").each(function(){$(this).filter(":visible").find("th").each(function(index,data){if("none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)){var colPosition=startColPosition+50*index;doc.text(colPosition,20,parseString($(this)))}})});var startRowPosition=20,page=1,rowPosition=0;$(el).find("tbody").find("tr").each(function(index,data){rowCalc=index+1,rowCalc%26==0&&(doc.addPage(),page++,startRowPosition+=10),rowPosition=startRowPosition+10*rowCalc-280*(page-1),$(this).filter(":visible").find("td").each(function(index,data){if("none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)){var colPosition=startColPosition+50*index;doc.text(colPosition,rowPosition,parseString($(this)))}})}),doc.output("datauri")}}})}(jQuery),jQuery.base64=function($){function _getbyte64(s,i){var idx=_ALPHA.indexOf(s.charAt(i));if(-1===idx)throw"Cannot decode base64";return idx}function _decode(s){var i,b10,pads=0,imax=s.length,x=[];if(s=String(s),0===imax)return s;if(imax%4!==0)throw"Cannot decode base64";for(s.charAt(imax-1)===_PADCHAR&&(pads=1,s.charAt(imax-2)===_PADCHAR&&(pads=2),imax-=4),i=0;imax>i;i+=4)b10=_getbyte64(s,i)<<18|_getbyte64(s,i+1)<<12|_getbyte64(s,i+2)<<6|_getbyte64(s,i+3),x.push(String.fromCharCode(b10>>16,b10>>8&255,255&b10));switch(pads){case 1:b10=_getbyte64(s,i)<<18|_getbyte64(s,i+1)<<12|_getbyte64(s,i+2)<<6,x.push(String.fromCharCode(b10>>16,b10>>8&255));break;case 2:b10=_getbyte64(s,i)<<18|_getbyte64(s,i+1)<<12,x.push(String.fromCharCode(b10>>16))}return x.join("")}function _getbyte(s,i){var x=s.charCodeAt(i);if(x>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return x}function _encode(s){if(1!==arguments.length)throw"SyntaxError: exactly one argument required";s=String(s);var i,b10,x=[],imax=s.length-s.length%3;if(0===s.length)return s;for(i=0;imax>i;i+=3)b10=_getbyte(s,i)<<16|_getbyte(s,i+1)<<8|_getbyte(s,i+2),x.push(_ALPHA.charAt(b10>>18)),x.push(_ALPHA.charAt(b10>>12&63)),x.push(_ALPHA.charAt(b10>>6&63)),x.push(_ALPHA.charAt(63&b10));switch(s.length-imax){case 1:b10=_getbyte(s,i)<<16,x.push(_ALPHA.charAt(b10>>18)+_ALPHA.charAt(b10>>12&63)+_PADCHAR+_PADCHAR);break;case 2:b10=_getbyte(s,i)<<16|_getbyte(s,i+1)<<8,x.push(_ALPHA.charAt(b10>>18)+_ALPHA.charAt(b10>>12&63)+_ALPHA.charAt(b10>>6&63)+_PADCHAR)}return x.join("")}var _PADCHAR="=",_ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_VERSION="1.0";return{decode:_decode,encode:_encode,VERSION:_VERSION}}(jQuery);var jsPDF=function(){function putTrailer(){out("/Size "+(objectNumber+1)),out("/Root "+objectNumber+" 0 R"),out("/Info "+(objectNumber-1)+" 0 R")}var pageHeight,k,fontNumber,version="20090504",buffer="",pdfVersion="1.3",pageFormats={a3:[841.89,1190.55],a4:[595.28,841.89],a5:[420.94,595.28],letter:[612,792],legal:[612,1008]},page=0,objectNumber=2,state=0,pages=new Array,offsets=new Array,lineWidth=.200025,unit="mm",documentProperties={},fontSize=16,pageFontSize=16;"pt"==unit?k=1:"mm"==unit?k=72/25.4:"cm"==unit?k=72/2.54:"in"==unit&&(k=72);var newObject=function(){objectNumber++,offsets[objectNumber]=buffer.length,out(objectNumber+" 0 obj")},putHeader=function(){out("%PDF-"+pdfVersion)},putPages=function(){var wPt=pageWidth*k,hPt=pageHeight*k;for(n=1;n<=page;n++)newObject(),out("<</Type /Page"),out("/Parent 1 0 R"),out("/Resources 2 0 R"),out("/Contents "+(objectNumber+1)+" 0 R>>"),out("endobj"),p=pages[n],newObject(),out("<</Length "+p.length+">>"),putStream(p),out("endobj");offsets[1]=buffer.length,out("1 0 obj"),out("<</Type /Pages");var kids="/Kids [";for(i=0;i<page;i++)kids+=3+2*i+" 0 R ";out(kids+"]"),out("/Count "+page),out(sprintf("/MediaBox [0 0 %.2f %.2f]",wPt,hPt)),out(">>"),out("endobj")},putStream=function(str){out("stream"),out(str),out("endstream")},putResources=function(){putFonts(),putImages(),offsets[2]=buffer.length,out("2 0 obj"),out("<<"),putResourceDictionary(),out(">>"),out("endobj")},putFonts=function(){newObject(),fontNumber=objectNumber,name="Helvetica",out("<</Type /Font"),out("/BaseFont /"+name),out("/Subtype /Type1"),out("/Encoding /WinAnsiEncoding"),out(">>"),out("endobj")},putImages=function(){},putResourceDictionary=function(){out("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),out("/Font <<"),out("/F1 "+fontNumber+" 0 R"),out(">>"),out("/XObject <<"),putXobjectDict(),out(">>")},putXobjectDict=function(){},putInfo=function(){out("/Producer (jsPDF "+version+")"),void 0!=documentProperties.title&&out("/Title ("+pdfEscape(documentProperties.title)+")"),void 0!=documentProperties.subject&&out("/Subject ("+pdfEscape(documentProperties.subject)+")"),void 0!=documentProperties.author&&out("/Author ("+pdfEscape(documentProperties.author)+")"),void 0!=documentProperties.keywords&&out("/Keywords ("+pdfEscape(documentProperties.keywords)+")"),void 0!=documentProperties.creator&&out("/Creator ("+pdfEscape(documentProperties.creator)+")");var created=new Date,year=created.getFullYear(),month=created.getMonth()+1,day=created.getDate(),hour=created.getHours(),minute=created.getMinutes(),second=created.getSeconds();out("/CreationDate (D:"+sprintf("%02d%02d%02d%02d%02d%02d",year,month,day,hour,minute,second)+")")},putCatalog=function(){out("/Type /Catalog"),out("/Pages 1 0 R"),out("/OpenAction [3 0 R /FitH null]"),out("/PageLayout /OneColumn")},endDocument=function(){state=1,putHeader(),putPages(),putResources(),newObject(),out("<<"),putInfo(),out(">>"),out("endobj"),newObject(),out("<<"),putCatalog(),out(">>"),out("endobj");var o=buffer.length;out("xref"),out("0 "+(objectNumber+1)),out("0000000000 65535 f ");for(var i=1;objectNumber>=i;i++)out(sprintf("%010d 00000 n ",offsets[i]));out("trailer"),out("<<"),putTrailer(),out(">>"),out("startxref"),out(o),out("%%EOF"),state=3},beginPage=function(){page++,state=2,pages[page]="",pageHeight=pageFormats.a4[1]/k,pageWidth=pageFormats.a4[0]/k},out=function(string){2==state?pages[page]+=string+"\n":buffer+=string+"\n"},_addPage=function(){beginPage(),out(sprintf("%.2f w",lineWidth*k)),pageFontSize=fontSize,out("BT /F1 "+parseInt(fontSize)+".00 Tf ET")};_addPage();var pdfEscape=function(text){return text.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")};return{addPage:function(){_addPage()},text:function(x,y,text){pageFontSize!=fontSize&&(out("BT /F1 "+parseInt(fontSize)+".00 Tf ET"),pageFontSize=fontSize);var str=sprintf("BT %.2f %.2f Td (%s) Tj ET",x*k,(pageHeight-y)*k,pdfEscape(text));out(str)},setProperties:function(properties){documentProperties=properties},addImage:function(imageData,format,x,y,w,h){},output:function(type,options){return endDocument(),void 0==type?buffer:void("datauri"==type&&(document.location.href="data:application/pdf;base64,"+Base64.encode(buffer)))},setFontSize:function(size){fontSize=size}}},Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(input){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",i=0;for(input=Base64._utf8_encode(input);i<input.length;)chr1=input.charCodeAt(i++),chr2=input.charCodeAt(i++),chr3=input.charCodeAt(i++),enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+this._keyStr.charAt(enc1)+this._keyStr.charAt(enc2)+this._keyStr.charAt(enc3)+this._keyStr.charAt(enc4);return output},decode:function(input){var chr1,chr2,chr3,enc1,enc2,enc3,enc4,output="",i=0;for(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<input.length;)enc1=this._keyStr.indexOf(input.charAt(i++)),enc2=this._keyStr.indexOf(input.charAt(i++)),enc3=this._keyStr.indexOf(input.charAt(i++)),enc4=this._keyStr.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,output+=String.fromCharCode(chr1),64!=enc3&&(output+=String.fromCharCode(chr2)),64!=enc4&&(output+=String.fromCharCode(chr3));return output=Base64._utf8_decode(output)},_utf8_encode:function(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);128>c?utftext+=String.fromCharCode(c):c>127&&2048>c?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext},_utf8_decode:function(utftext){for(var string="",i=0,c=c1=c2=0;i<utftext.length;)c=utftext.charCodeAt(i),128>c?(string+=String.fromCharCode(c),i++):c>191&&224>c?(c2=utftext.charCodeAt(i+1),string+=String.fromCharCode((31&c)<<6|63&c2),i+=2):(c2=utftext.charCodeAt(i+1),c3=utftext.charCodeAt(i+2),string+=String.fromCharCode((15&c)<<12|(63&c2)<<6|63&c3),i+=3);return string}};$(document).ready(function(){function fix_height(){var heightWithoutNavbar=$("body > #wrapper").height()-61;$(".sidebard-panel").css("min-height",heightWithoutNavbar+"px");var navbarHeigh=$("nav.navbar-default").height(),wrapperHeigh=$("#page-wrapper").height();navbarHeigh>wrapperHeigh&&$("#page-wrapper").css("min-height",navbarHeigh+"px"),wrapperHeigh>navbarHeigh&&$("#page-wrapper").css("min-height",$(window).height()+"px"),$("body").hasClass("fixed-nav")&&(navbarHeigh>wrapperHeigh?$("#page-wrapper").css("min-height",navbarHeigh-60+"px"):$("#page-wrapper").css("min-height",$(window).height()-60+"px"))}$(window).bind("load resize scroll",function(){$("body").hasClass("body-small")||fix_height()}),$(window).scroll(function(){$(window).scrollTop()>0&&!$("body").hasClass("fixed-nav")?$("#right-sidebar").addClass("sidebar-top"):$("#right-sidebar").removeClass("sidebar-top")}),setTimeout(function(){fix_height()})}),$(function(){$(window).bind("load resize",function(){$(document).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small")})});var app=angular.module("yconta",["ui.router","ui.bootstrap","ngMessages","auth0","angular-storage","angular-jwt","angular-ladda","angularUtils.directives.dirPagination","common","ycontaFilters","ncy-angular-breadcrumb"]);app.run(function($rootScope,$state,auth,store,jwtHelper,$uibModalStack,$uibModal,$location,roleService,sessionService){"use strict";$rootScope.returnToState="",$rootScope.returnToStateParams="",auth.hookEvents(),$rootScope.$on("$locationChangeStart",function(e,next,current){if(!auth.isAuthenticated){var token=store.get("token");token&&(jwtHelper.isTokenExpired(token)?$state.go("login"):(auth.authenticate(store.get("profile"),token),sessionService.usuarioAtual=auth.profile))}roleService.contemRota($location.path(),roleService.adminRoutes)&&!roleService.validateRoleAdmin(sessionService.usuarioAtual)&&(e.preventDefault(),$state.go("401"))}),$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams,options){if($uibModalStack.dismissAll(),toState.data.empresaObrigatoria&&null==sessionService.filtrosContexto.empresaId){$rootScope.returnToState=toState.name,$rootScope.returnToStateParams=toParams;var modalInstance=$uibModal.open({templateUrl:"common/seletor/seletorView.html",windowClass:"inmodal animated bounceInRight",controller:"SeletorController"});modalInstance.rendered.then(function(){$("#select-empresa").multipleSelect({filter:!0,noMatchesFound:"Nenhum registro encontrado",selectAllText:" Selecionar todas ",allSelected:"[Todas as Contas]",countSelected:"# de % selecionadas"})}),modalInstance.result["finally"](function(){$rootScope.returnToState="",$rootScope.returnToStateParams=""}),event.preventDefault()}}),$rootScope.$on("$stateChangeError",function(event,toState,toParams,fromState,fromParams,error){console.log("stateChangeError"),console.log(toState,toParams,fromState,fromParams,error),401==error.status&&(console.log("Opa ! 401 detectado. ¬¬ Redirecionando..."),$state.go("login"))})}),toastr.options.timeOut=1e4,toastr.options.positionClass="toast-top-right",toastr.options.closeButton="true",toastr.options.progressBar="true";var webApiServer="http://yconta.azurewebsites.net/api/",auth0={domain:"yconta.auth0.com",clientID:"LkqVBgcrtDej9Gm0uXrwDU2ZS23s29hZ",loginState:"login"},events={},config={version:"1.0.0",appErrorPrefix:"[YC+ Error] ",events:events,webApiServer:webApiServer,tamanhoPagina:"10"};app.value("config",config),app.config(["$logProvider",function($logProvider){$logProvider.debugEnabled&&$logProvider.debugEnabled(!0)}]),app.config(function(authProvider){authProvider.init(auth0),authProvider.on("loginSuccess",function($location,profilePromise,idToken,store){console.log("Login Success"),profilePromise.then(function(profile){store.set("profile",profile),store.set("token",idToken)})}),authProvider.on("loginFailure",function(){}),authProvider.on("authenticated",function(){})}),app.config(function($httpProvider,jwtInterceptorProvider){jwtInterceptorProvider.tokenGetter=function(store){return store.get("token")},$httpProvider.interceptors.push("jwtInterceptor")}),app.config(function($breadcrumbProvider){$breadcrumbProvider.setOptions({prefixStateName:"index.home"})}),app.config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("index",{"abstract":!0,templateUrl:"layout/content.html",data:{requiresLogin:!0,breadcrumbProxy:"index.home"}}).state("index.home",{url:"/",templateUrl:"components/home/homeView.html",data:{pageTitle:"Página Inicial"},ncyBreadcrumb:{label:"Home"}}).state("login",{url:"/login",controller:"LoginController",templateUrl:"common/account/loginView.html",data:{pageTitle:"Login",specialClass:"gray-bg"}}).state("401",{templateUrl:"layout/errorViews/401.html",data:{pageTitle:"Acesso negado",specialClass:"gray-bg"}})}),app.config(["$provide",function($provide){$provide.decorator("$exceptionHandler",["$delegate","config","logger",extendExceptionHandler])}]),app.directive("iboxTools",function($timeout){return{restrict:"A",scope:!0,templateUrl:"layout/ibox/iboxView.html",controller:function($scope,$element,$attrs){var tableSelectorToExport=$attrs.tableselectortoexport?$attrs.tableselectortoexport:".table",ignoreColumns=$attrs.ignorecolumns?$attrs.ignorecolumns:[];$scope.showhide=function(){var ibox=$element.closest("div.ibox"),icon=$element.find("i:last"),content=ibox.find("div.ibox-content");content.slideToggle(200),icon.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),ibox.toggleClass("").toggleClass("border-bottom"),$timeout(function(){ibox.resize(),ibox.find("[id^=map-]").resize()},50)},$scope.closebox=function(){var ibox=$element.closest("div.ibox");ibox.remove()},$scope.printTable=function(){var conteudoTabela=$(tableSelectorToExport)[0].outerHTML;novaJanela=window.open("");var css="<style>body { font-family: 'open sans','Helvetica Neue',Helvetica,Arial,sans-serif; }table { border-collapse: collapse; } table th, table td { font-size: 10px; border: 1px solid #000; padding: 2px; }table th { background-color: #ccc; }table td.naoImprimir, table th.naoImprimir { display:none; } a, a:visited { text-decoration:none; color: #000; }</style>",conteudo="<html><head><title></title>"+css+"</head><body>"+conteudoTabela+"</body>";return novaJanela.document.write(conteudo),novaJanela.print(),novaJanela.close(),!1},$scope.exportToExcel=function(){$(tableSelectorToExport).tableExport({type:"excel",escape:"false",ignoreColumn:ignoreColumns})},$scope.exportToPDF=function(){$(tableSelectorToExport).tableExport({type:"pdf",pdfFontSize:"7",escape:"false",ignoreColumn:ignoreColumns})}}}}),app.directive("iboxToolsFullScreen",function($timeout){return{restrict:"A",scope:!0,templateUrl:"views/common/ibox_tools_full_screen.html",controller:function($scope,$element){$scope.showhide=function(){var ibox=$element.closest("div.ibox"),icon=$element.find("i:first"),content=ibox.find("div.ibox-content");content.slideToggle(200),icon.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),ibox.toggleClass("").toggleClass("border-bottom"),$timeout(function(){ibox.resize(),ibox.find("[id^=map-]").resize()},50)},$scope.closebox=function(){var ibox=$element.closest("div.ibox");ibox.remove()},$scope.fullscreen=function(){var ibox=$element.closest("div.ibox"),button=$element.find("i.fa-expand");$("body").toggleClass("fullscreen-ibox-mode"),button.toggleClass("fa-expand").toggleClass("fa-compress"),ibox.toggleClass("fullscreen"),setTimeout(function(){$(window).trigger("resize")},100)}}}}),app.directive("pageTitle",function($rootScope,$timeout){return{link:function(scope,element){var listener=function(event,toState,toParams,fromState,fromParams){var title="YConta - Gestão em Telecomunicações";toState.data&&toState.data.pageTitle&&(title="YConta - Gestão em Telecomunicações | "+toState.data.pageTitle),$timeout(function(){element.text(title)})};$rootScope.$on("$stateChangeStart",listener)}}}),app.directive("sideNavigation",function($timeout){return{restrict:"A",link:function(scope,element){$timeout(function(){element.metisMenu()})}}}),app.directive("minimalizaSidebar",function($timeout){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="" ng-click="minimalize()"><i class="fa fa-bars"></i></a>',controller:function($scope,$element){$scope.minimalize=function(){$("body").toggleClass("mini-navbar"),!$("body").hasClass("mini-navbar")||$("body").hasClass("body-small")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(400)},200)):$("body").hasClass("fixed-sidebar")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(400)},100)):$("#side-menu").removeAttr("style")}}}}),app.directive("ccScrollToTop",["$window",function($window){function link(scope,element,attrs){function toggleIcon(){$win.scrollTop()>300?element.slideDown():element.slideUp()}var $win=$($window);element.addClass("totop"),$win.scroll(toggleIcon),element.find("a").click(function(e){e.preventDefault(),$("body").animate({scrollTop:0},500)})}var directive={link:link,template:'<a href="#"><i class="fa fa-chevron-up"></i></a>',restrict:"A"};return directive}]),angular.module("ycontaFilters",[]).filter("limitWithRet",limitWithRetFilter),function(){"use strict";function common($q,$rootScope,$timeout,logger){function $broadcast(){return $rootScope.$broadcast.apply($rootScope,arguments)}function isNumber(val){return/^[-]?\d+$/.test(val)}function textContains(text,searchText){return text&&-1!==text.toLowerCase().indexOf(searchText.toLowerCase())}var service={$broadcast:$broadcast,$q:$q,$timeout:$timeout,isNumber:isNumber,logger:logger,textContains:textContains};return service}var commonModule=angular.module("common",[]);commonModule.factory("common",["$q","$rootScope","$timeout","logger",common])}(),function(){"use strict";function logger($log){function getLogFn(moduleId,fnName){switch(fnName=fnName||"log",fnName.toLowerCase()){case"success":fnName="logSuccess";break;case"error":fnName="logError";break;case"warn":fnName="logWarning";break;case"warning":fnName="logWarning"}var logFn=service[fnName]||service.log;return function(msg,data,showToast){logFn(msg,data,moduleId,void 0===showToast?!0:showToast)}}function log(message,data,source,showToast){logIt(message,data,source,showToast,"info")}function logWarning(message,data,source){logIt(message,data,source,!0,"warning")}function logSuccess(message,data,source){logIt(message,data,source,!0,"success")}function logError(message,data,source){logIt(message,data,source,!0,"error")}function logIt(message,data,source,showToast,toastType){var write="error"===toastType?$log.error:$log.log;source=source?"["+source+"] ":"",write(source,message,data),showToast&&("error"===toastType?toastr.error(message,"Ops ! Ocorreu um erro na aplicação.",{timeOut:"0",positionClass:"toast-bottom-full-width"}):"warning"===toastType?toastr.warning(message):"success"===toastType?toastr.success(message):toastr.info(message))}var service={getLogFn:getLogFn,log:log,logError:logError,logSuccess:logSuccess,logWarning:logWarning};return service}angular.module("common").factory("logger",["$log",logger])}(),app.factory("authenticationService",function($q,auth,store,sessionService){"use strict";return{login:function(loginData){return $q(function(resolve,reject){auth.signin({username:loginData.userName,password:loginData.password,connection:"Username-Password-Authentication",sso:!1,authParams:{scope:"openid app_metadata user_metadata name email"}},function(profile,idToken,accessToken,state,refreshToken){sessionService.usuarioAtual=auth.profile,resolve(profile,idToken,accessToken,state,refreshToken)},function(error){reject(error.details.error_description)},"Auth0")})},logoff:function(){return $q(function(resolve,reject){auth.signout(),store.remove("profile"),store.remove("token"),sessionService.limparFiltrosDeContexto(),resolve()})},isLoggedIn:function(){return auth.isAuthenticated}}}),app.factory("roleService",function(){"use strict";var adminRoles=["Administrador","editor"],otherRoles=["Usuario"],adminRoutes=["/centroCusto"];return{adminRoutes:adminRoutes,validateRoleAdmin:function(usuarioAtual){var isValid=!1;return null!=usuarioAtual&&void 0!=usuarioAtual||(isValid=!1),$.grep(adminRoles,function(v,i){return $.inArray(v,usuarioAtual.roles)>=0?void(isValid=!0):void 0}),isValid},validateRoleOther:function(usuarioAtual){return usuarioAtual?$.contains(otherRoles,usuarioAtual.roles):!1},contemRota:function(rota,listaRotas){var contem=!1;return $(listaRotas).each(function(i){return null!=rota.match("^"+this)?void(contem=!0):void 0}),contem}}}),app.factory("sessionService",["store",function(store){"use strict";var filtrosContextoPadrao={empresaId:null,centroCustos:[],contas:[]};return{usuarioAtual:null,filtrosContexto:null==store.get("filtrosContexto")?$.extend({},filtrosContextoPadrao):store.get("filtrosContexto"),setFiltrosDeContexto:function(filtrosContexto){return this.filtrosContexto=filtrosContexto,store.set("filtrosContexto",filtrosContexto)},limparFiltrosDeContexto:function(){return this.filtrosContexto=$.extend({},filtrosContextoPadrao),store.set("filtrosContexto",this.filtrosContexto)}}}]),app.service("queryStringService",function($location){this.obterFiltros=function(filterObj){var qs=$location.search();for(var param in filterObj)param in qs&&(filterObj[param]=qs[param]);return filterObj},this.atualizarFiltros=function(filterObj){var novaQueryString={};for(var param in filterObj)""!=filterObj[param]&&(novaQueryString[param]=filterObj[param]);
$location.search(novaQueryString)}}),app.directive("backButton",function(){return{restrict:"A",link:function(scope,element,attrs){function goBack(){history.back(),scope.$apply()}element.bind("click",goBack)}}}),app.directive("seletor",function($uibModal){return{restrict:"A",scope:!0,template:'<span class="btn btn-primary" ng-click="abrirSeletor()"><i class="fa fa-exchange"></i> {{ nomeEmpresa }}</span>',controller:function($scope,$element,$attrs){$scope.nomeEmpresa="Selecionar empresa",$scope.abrirSeletor=function(){var modalInstance=$uibModal.open({templateUrl:"common/seletor/seletorView.html",windowClass:"inmodal animated bounceInRight",controller:"SeletorController"});modalInstance.rendered.then(function(){$("#select-empresa").multipleSelect({filter:!0,noMatchesFound:"Nenhum registro encontrado",selectAllText:" Selecionar todas ",allSelected:"[Todas as Contas]",countSelected:"# de % selecionadas"})}),modalInstance.result["finally"](function(){$rootScope.returnToState="",$rootScope.returnToStateParams=""}),modalInstance.result.then(function(selectedItem){$scope.nomeEmpresa=selectedItem},function(){})}}}}),app.controller("SeletorController",function($scope,$rootScope,$state,$uibModalInstance,common,sessionService){"use strict";$scope.fechar=function(){$uibModalInstance.dismiss()},$scope.selecionar=function(){var filtro=sessionService.filtrosContexto;filtro.empresaId=1,sessionService.setFiltrosDeContexto(filtro),$rootScope.returnToState&&$state.go($rootScope.returnToState,$rootScope.returnToStateParams),$uibModalInstance.close({teste:"123"})}}),app.controller("LoginController",function($scope,$location,authenticationService){$scope.loadingData=!1,$scope.loginData={userName:"",password:""},$scope.message="",$scope.login=function(isValid){isValid&&($scope.loadingData=!0,authenticationService.login($scope.loginData).then(function(profile,idToken,accessToken,state,refreshToken){$location.path("/"),$scope.loadingData=!1},function(errorMsg){$scope.message=errorMsg,$scope.loadingData=!1}))}});var controllerId="MainController";app.controller(controllerId,function($scope,$state,common,authenticationService,sessionService){$scope.$state=$state,this.helloText="Welcome in SeedProject",this.descriptionText="It is an application skeleton for a typical AngularJS web app. You can use it to quickly bootstrap your angular webapp projects and dev environment for these projects.",$scope.logOut=function(){console.log("Saindo: "+sessionService.usuarioAtual.nickname),authenticationService.logoff().then(function(){$state.go("login")})}}),app.config(function($stateProvider,$urlRouterProvider){$stateProvider.state("centroCusto",{"abstract":!0,templateUrl:"layout/content.html",data:{pageTitle:"Centro de Custos",requiresLogin:!0}}).state("centroCusto.lista",{url:"/centroCusto?paginaAtual&tamanhoPagina",resolve:{centroCusto:function(){return{}}},controller:"CentroCustoController",templateUrl:"components/centroCusto/lista.html",params:{paginaAtual:{value:"1"},tamanhoPagina:{value:config.tamanhoPagina}},reloadOnSearch:!1,data:{pageTitle:"Centro de Custos",empresaObrigatoria:!0},ncyBreadcrumb:{label:"Centro de Custos"}}).state("centroCusto.lista.editar",{url:"/editar/:id",onEnter:function($uibModal,$state,$stateParams,centroCustoService){$uibModal.open({templateUrl:"components/centroCusto/form-modal.html",windowClass:"animated bounceIn",resolve:{centroCusto:function(){return centroCustoService.obter($stateParams.id)}},controller:"CentroCustoController"}).result["finally"](function(){$state.go("centroCusto.lista")})},onExit:function(){}}).state("centroCusto.criar",{url:"/centroCusto/criar",resolve:{centroCusto:function(){return{}}},controller:"CentroCustoController",templateUrl:"components/centroCusto/form.html",data:{pageTitle:"Centro de Custos",empresaObrigatoria:!0},ncyBreadcrumb:{label:"Novo",parent:"centroCusto.lista"}}).state("centroCusto.editar",{url:"/centroCusto/:id",controller:"CentroCustoController",templateUrl:"components/centroCusto/form.html",data:{pageTitle:"Centro de Custos",empresaObrigatoria:!0},resolve:{centroCusto:function($stateParams,centroCustoService){return centroCustoService.obter($stateParams.id)}},ncyBreadcrumb:{label:"{{ centroCusto.nome | limitWithRet:20 }}",parent:"centroCusto.lista"}})}),app.controller("CentroCustoController",function($scope,$state,$stateParams,common,sessionService,centroCustoService,queryStringService,centroCusto){$scope.centroCusto=centroCusto.data,$scope.totalRegistros=0,$scope.carregando=!1;var filtros={paginaAtual:"",tamanhoPagina:config.tamanhoPagina,id:"",nome:""};$scope.filtros=queryStringService.obterFiltros(filtros);var pesquisar=function(paginaAtual){centroCustoService.pesquisar($.extend({},$scope.filtros,sessionService.filtrosContexto)).then(function(results){$scope.centrosCustos=results.data.entidades,$scope.totalRegistros=results.data.totalRegistros,$scope.filtros.paginaAtual=paginaAtual});queryStringService.atualizarFiltros($scope.filtros)};$scope.pesquisar=pesquisar,"centroCusto.lista"==$state.current.name&&$scope.pesquisar($scope.filtros.paginaAtual),$scope.salvar=function(isValid){$scope.carregando=!0,isValid&&centroCustoService.salvar($scope.centroCusto).then(function(results){common.logger.logSuccess("Registro salvo com sucesso!"),$scope.carregando=!1},function(error){common.logger.logError(error.data.exceptionMessage,error.data),$scope.carregando=!1})},$scope.deletar=function(centroCusto){swal({title:"Tem certeza?",text:"Você irá deletar esse registro e não poderá recuperá-lo depois.",type:"warning",showCancelButton:!0,confirmButtonText:"Sim",cancelButtonText:"Não",closeOnConfirm:!1,showLoaderOnConfirm:!0},function(isConfirm){isConfirm&&centroCustoService.deletar(centroCusto.id).then(function(results){pesquisar($scope.filtros.paginaAtual),swal.close()})})}}),app.factory("centroCustoService",function($http,config,sessionService){var serviceBase=config.webApiServer,centroCustoServiceFactory={};return centroCustoServiceFactory.pesquisar=function(filtros){return $http.get(serviceBase+"centroCusto?"+$.param(filtros))},centroCustoServiceFactory.obterTodos=function(){return $http.get(serviceBase+"centroCusto").then(function(results){return results})},centroCustoServiceFactory.obter=function(id){return $http.get(serviceBase+"centroCusto/"+id).then(function(results){return results})},centroCustoServiceFactory.salvar=function(centroCusto){return centroCusto.id?$http.put(serviceBase+"centroCusto/"+centroCusto.id,centroCusto):(centroCusto.empresaId=sessionService.filtrosContexto.empresaId,$http.post(serviceBase+"centroCusto",centroCusto))},centroCustoServiceFactory.deletar=function(id){return $http["delete"](serviceBase+"centroCusto/"+id)},centroCustoServiceFactory});